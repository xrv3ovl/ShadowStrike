/**
 * ============================================================================
 * ShadowStrike Exploits - STACK PIVOT DETECTOR (The Balancer)
 * ============================================================================
 *
 * @file StackPivotDetector.hpp
 * @brief Detection of moved stack pointers (ESP/RSP).
 *
 * ROP attacks often move the stack pointer to the heap (Stack Pivot).
 * This module checks if ESP points to the valid Thread Stack range.
 *
 * @author ShadowStrike Security Team
 * @version 3.0.0
 * @copyright 2026 ShadowStrike Security Suite
 */

#pragma once

#include <cstdint>

namespace ShadowStrike {
    namespace Exploits {

        class StackPivotDetector {
        public:
            static StackPivotDetector& Instance();

            /**
             * @brief Verify that the Stack Pointer is within valid Thread Stack limits.
             */
            bool ValidateStackPointer(uint32_t tid, uintptr_t sp);

        private:
            StackPivotDetector() = default;
        };

    } // namespace Exploits
} // namespace ShadowStrike
