/**
 * ============================================================================
 * ShadowStrike Exploits - HEAP SPRAY DETECTOR (The Cleaner)
 * ============================================================================
 *
 * @file HeapSprayDetector.hpp
 * @brief Detection of massive repetitive memory allocations.
 *
 * Heap Spraying fills memory with NOP sleds + Shellcode to increase exploit reliability.
 *
 * Detection:
 * - Scan heap for high entropy/uniformity blocks.
 * - Detect huge number of similar allocations.
 *
 * @author ShadowStrike Security Team
 * @version 3.0.0
 * @copyright 2026 ShadowStrike Security Suite
 */

#pragma once

#include "../../Core/Process/MemoryScanner.hpp"
#include <cstdint>

namespace ShadowStrike {
    namespace Exploits {

        class HeapSprayDetector {
        public:
            static HeapSprayDetector& Instance();

            /**
             * @brief Scan a process heap for spray patterns.
             */
            bool AnalyzeHeap(uint32_t pid);

        private:
            HeapSprayDetector() = default;
        };

    } // namespace Exploits
} // namespace ShadowStrike
