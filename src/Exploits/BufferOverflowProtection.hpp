/**
 * ============================================================================
 * ShadowStrike Exploits - BUFFER OVERFLOW PROTECTION (The Wall)
 * ============================================================================
 *
 * @file BufferOverflowProtection.hpp
 * @brief Runtime detection of Stack and Heap overflows.
 *
 * NOTE: True Buffer Overflow protection usually requires compiler support (/GS)
 * or OS support (DEP/ASLR). This module implements *Behavioral* detection
 * by inspecting crashes (Exception Handling) and Memory Access Violations.
 *
 * @author ShadowStrike Security Team
 * @version 3.0.0
 * @copyright 2026 ShadowStrike Security Suite
 */

#pragma once

#include "../../Core/Process/ProcessMonitor.hpp"
#include <cstdint>

namespace ShadowStrike {
    namespace Exploits {

        class BufferOverflowProtection {
        public:
            static BufferOverflowProtection& Instance();

            /**
             * @brief Analyze an exception to see if it was caused by an overflow.
             * e.g., EIP points to Stack memory (DEP violation).
             */
            bool AnalyzeCrash(
                uint32_t pid, 
                uint32_t exceptionCode, 
                uintptr_t faultAddress
            );

        private:
            BufferOverflowProtection() = default;
        };

    } // namespace Exploits
} // namespace ShadowStrike
