/**
 * ============================================================================
 * ShadowStrike Exploits - KERNEL EXPLOIT DETECTOR (The Ring 0 Guard)
 * ============================================================================
 *
 * @file KernelExploitDetector.hpp
 * @brief Detection of Privilege Escalation to SYSTEM/Kernel.
 *
 * Checks for:
 * 1. Driver Loading: Is an unsigned driver being loaded?
 * 2. Token Stealing: Did a process suddenly become SYSTEM?
 * 3. Null Pointer Deference (less common now but valid).
 *
 * @author ShadowStrike Security Team
 * @version 3.0.0
 * @copyright 2026 ShadowStrike Security Suite
 */

#pragma once

#include "../../Core/System/ServiceManager.hpp"
#include <cstdint>

namespace ShadowStrike {
    namespace Exploits {

        class KernelExploitDetector {
        public:
            static KernelExploitDetector& Instance();

            /**
             * @brief Monitor for new driver loading attempts.
             * Called by `ServiceManager` or `RegistryMonitor`.
             */
            bool AnalyzeDriverLoad(const std::wstring& driverPath);

            /**
             * @brief Check if a process token was modified in memory (Token Stealing).
             */
            bool DetectTokenManipulation(uint32_t pid);

        private:
            KernelExploitDetector() = default;
        };

    } // namespace Exploits
} // namespace ShadowStrike
