/**
 * ============================================================================
 * ShadowStrike Exploits - ROP PROTECTION (The Chain Breaker)
 * ============================================================================
 *
 * @file ROPProtection.hpp
 * @brief Detection of Return-Oriented Programming (ROP) chains.
 *
 * ROP attacks execute code by jumping to existing "gadgets" (small code chunks ending in RET).
 * 
 * Techniques:
 * 1. Shadow Stack: Maintain a parallel stack and compare RET addresses.
 * 2. Critical Function Monitoring: Check stack integrity when `VirtualProtect` is called.
 *
 * @author ShadowStrike Security Team
 * @version 3.0.0
 * @copyright 2026 ShadowStrike Security Suite
 */

#pragma once

#include <cstdint>
#include <vector>

namespace ShadowStrike {
    namespace Exploits {

        class ROPProtection {
        public:
            static ROPProtection& Instance();

            /**
             * @brief Verify the call stack before allowing a critical API.
             * Called via API Hooks (e.g. on VirtualProtect).
             */
            bool ValidateCallStack(uint32_t threadId);

        private:
            ROPProtection() = default;
        };

    } // namespace Exploits
} // namespace ShadowStrike
